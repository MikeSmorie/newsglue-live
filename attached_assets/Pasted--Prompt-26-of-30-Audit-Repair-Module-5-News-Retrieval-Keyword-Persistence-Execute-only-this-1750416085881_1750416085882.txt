
Prompt 26 of 30 â€” Audit & Repair Module 5 News Retrieval & Keyword Persistence



Execute only this prompt and donâ€™t try to interpret or anticipate what comes next.

ğŸ§© Purpose:



Audit and repair the data flow of Module 5 to restore:

Persistent keyword storage and recall

Proper news search â†’ storage â†’ display loop

ğŸ” Problems Identified:

âœ… AI-suggested keywords generate properly but fail to persist

âœ… Manual keywords like â€œSaylorâ€ say â€œaddedâ€ but do not appear

âœ… System claims â€œ20 articles foundâ€ but shows 0 in UI

âœ… Previously working display logic now fails after backend changes

âœ… Logs indicate route collisions and UUID structure validation failure

ğŸ› ï¸ Scope of Work:



1. âœ… Audit All Relevant Backend Files:

server/routes/google-news.ts

server/routes/google-news-simple.ts

server/db/schema/googleNewsArticles.ts

server/db/schema/googleNewsKeywords.ts

client/src/modules/module5/index.tsx

client/src/components/KeywordPanel.tsx

client/src/components/NewsResultsPanel.tsx



Focus:

Confirm the correct DB-backed route (google-news-simple.ts) is the one registered

Eliminate route conflicts â€” only 1 handler must control /api/google-news/articles/...



2. âœ… Fix Keyword Persistence

Confirm user-added and AI-generated keywords write to database

Ensure correct campaign ID is attached and retrieved on load

Display should reflect stored keywords with appropriate tools (ğŸ–Šï¸ edit, ğŸ” search, ğŸ—‘ï¸ delete)



3. âœ… Fix Article Retrieval & Display

Confirm search results are saved to database and retrieved from DB (not memory)

Refactor article GET handler:

res.set('Cache-Control', 'no-store, no-cache, must-revalidate');
Confirm campaignId is passed and respected in both store and retrieve functions

Fix race condition where articles are stored before component mounts



4. âœ… Logs & Debug Flags

Add console log: MODULE5: Loading articles for campaign: ${campaignId}

On frontend: console.log('Rendering articles:', articles.length)

Add error log if campaign ID is missing or malformed (root cause of invalid UUID error)

ğŸ§ª Test & Confirm:



âœ… Suggest keywords â†’ persist

âœ… Add manual keyword â€œSaylorâ€ â†’ shows in panel

âœ… Click â€œSearch Allâ€ â†’ shows loading â†’ returns articles

âœ… â€œ20 articles foundâ€ â†’ 20 articles display visibly

âœ… No more UUID errors in backend logs

Let me know when youâ€™ve verified â€” then weâ€™ll proceed to Prompt 27.